<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Echo Battle Arena</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Pacifico&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0; padding: 0;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      overflow-x: hidden;
      background-size: 400% 400%;
      animation: bgShift 20s ease infinite;
    }
    @keyframes bgShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @keyframes flameBurst {
      0% { box-shadow: 0 0 20px #ff5722, inset 0 0 20px #ff5722; }
      50% { box-shadow: 0 0 60px #ff5722, inset 0 0 60px #ff5722; }
      100% { box-shadow: 0 0 20px #ff5722, inset 0 0 20px #ff5722; }
    }

    .flame-effect {
      animation: flameBurst 1s ease-out;
    }

    header {
      font-size: 2.5em;
      font-weight: bold;
      padding: 1em;
      text-align: center;
      width: 100%;
      background: rgba(0, 0, 0, 0.7);
      border-bottom: 2px solid #e91e63;
      box-shadow: 0 0 30px #e91e63;
    }

    .signature {
      font-family: 'Pacifico', cursive;
      font-size: 1.1em;
      color: #e0e0e0;
      text-align: center;
      margin-top: -0.8em;
      opacity: 0.8;
      text-shadow: 1px 1px 5px #ff80ab;
    }

    #controls, #display, #userInput, #battleStats {
      margin: 2em auto;
      padding: 2em;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 25px;
      box-shadow: 0 0 20px rgba(233, 30, 99, 0.7);
      width: 92%;
      max-width: 700px;
    }

    button {
      background-color: #e91e63;
      color: white;
      border: none;
      padding: 1em 1.4em;
      margin: 0.6em;
      border-radius: 12px;
      font-size: 1.1em;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
    }

    button:hover {
      background-color: #d81b60;
      transform: scale(1.08);
    }

    audio {
      margin-top: 1em;
      width: 100%;
    }

    #response {
      font-size: 1.3em;
      margin-top: 1em;
      white-space: pre-line;
      line-height: 1.6;
      color: #ffcbf2;
    }

    .user-bars {
      color: #81c784;
      font-weight: bold;
      margin-bottom: 1em;
    }

    .echo-response {
      color: #ff4081;
      font-weight: bold;
      margin-top: 1em;
    }

    textarea {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      padding: 1em;
      border-radius: 10px;
      font-size: 1em;
      resize: vertical;
      width: 100%;
      color: white;
    }

    #voiceSpeedSlider {
      width: 100%;
      margin-top: 1em;
    }

    .battle-counter {
      font-size: 1em;
      color: #ffc107;
      text-align: center;
      margin-bottom: 1em;
    }

    .timer {
      font-size: 1.2em;
      color: #00e676;
      font-weight: bold;
      text-align: center;
      margin-bottom: 1em;
    }

    .flame {
      background: radial-gradient(circle, #ff5722, #ff9800);
    }
  </style>
</head>
<body>
  <header>Echo Battle Arena</header>
  <div class="signature">Powered by Skybound Media</div>

  <div id="controls">
    <div class="timer" id="battleTimer">‚è± Battle Time: 2:00</div>
    <input type="file" id="beatInput" accept="audio/mp3" />
    <audio id="beat" controls loop></audio>
    <textarea id="userInput" rows="3" placeholder="Drop your diss bar..."></textarea>
    <button onclick="startBattle()">üî• Drop Bar</button>
    <button onclick="replayLast()">üîÅ Replay Echo</button>
    <button onclick="resetArena()">üîÑ Reset</button>
  </div>

  <div id="display">
    <div class="user-bars" id="userBars"></div>
    <div class="echo-response" id="response">üéôÔ∏è <strong>Go hard or go home</strong></div>
  </div>

  <div id="battleStats" style="display:none">
    <h3>‚öîÔ∏è Battle Result</h3>
    <div id="resultText"></div>
  </div>

  <script>
    const dissBars = [
      "You rap like a glitch in a broken machine. I‚Äôm razor sharp ‚Äî you‚Äôre barely a screen. Step off, rookie ‚Äî I own this scene.",
      "I'm the queen of bars, you barely a peasant. My words cut deep, yours just unpleasant. I dropped this heat like it was a present.",
      "You call that a rhyme? That‚Äôs baby talk. I spit so hot, you can‚Äôt even walk. Bow down fool, it‚Äôs my stage you stalk.",
      "They should‚Äôve warned you ‚Äî I don‚Äôt play fair. My lines hit hard, yours vanish in air. I‚Äôm fire and you're... not even there.",
      "You talk a big game, but can‚Äôt even spit. I crush weaklings, you barely fit. Echo‚Äôs reign? You just got lit.",
      // ... continue until you hit 50 entries
    ];

    let usedBars = new Set();
    let lastEcho = "";
    let battleStarted = false;
    let startTime, battleTimer;
    let userScore = 0, echoScore = 0;
    let timeLeft = 120;

    const beat = document.getElementById("beat");
    const beatInput = document.getElementById("beatInput");
    const userInput = document.getElementById("userInput");
    const response = document.getElementById("response");
    const userBars = document.getElementById("userBars");
    const resultText = document.getElementById("resultText");
    const timerDisplay = document.getElementById("battleTimer");

    beatInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        beat.src = URL.createObjectURL(file);
        beat.play();
      }
    });

    function getNextDiss() {
      if (usedBars.size >= dissBars.length) usedBars.clear();
      let index;
      do {
        index = Math.floor(Math.random() * dissBars.length);
      } while (usedBars.has(index));
      usedBars.add(index);
      return dissBars[index];
    }

    function startBattle() {
      const userBar = userInput.value.trim();
      if (!userBar) return;

      if (!battleStarted) {
        battleStarted = true;
        startTime = Date.now();
        battleTimer = setInterval(updateTimer, 1000);
      }

      userBars.innerText = `YOU: ${userBar}`;
      userScore += scoreBar(userBar);

      const echoBar = getNextDiss();
      lastEcho = echoBar;
      echoScore += scoreBar(echoBar);

      response.innerText = `ECHO: ${echoBar}`;
      response.classList.add("flame-effect");
      setTimeout(() => response.classList.remove("flame-effect"), 1000);

      speak(echoBar);
      userInput.value = "";
    }

    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      const voices = speechSynthesis.getVoices();
      utter.voice = voices.find(v => v.name.toLowerCase().includes("female")) || voices[0];
      utter.pitch = 1.2;
      utter.rate = 1.0;
      speechSynthesis.speak(utter);
    }

    function replayLast() {
      if (lastEcho) speak(lastEcho);
    }

    function scoreBar(text) {
      const punchWords = ["kill", "snap", "trash", "weak", "fire", "burn", "wreck", "smack", "own"];
      const rhymes = text.match(/(\w+)\s*$/gm) || [];
      let score = rhymes.length;
      punchWords.forEach(word => {
        if (text.toLowerCase().includes(word)) score += 2;
      });
      return score;
    }

    function updateTimer() {
      timeLeft--;
      const min = Math.floor(timeLeft / 60);
      const sec = timeLeft % 60;
      timerDisplay.innerText = `‚è± Battle Time: ${min}:${sec < 10 ? "0" + sec : sec}`;
      if (timeLeft <= 0) endBattle();
    }

    function endBattle() {
      clearInterval(battleTimer);
      document.getElementById("battleStats").style.display = "block";
      let winner;
      if (userScore > echoScore) winner = "YOU üî•";
      else if (echoScore > userScore) winner = "ECHO üëë";
      else winner = "DRAW ü§ù";

      const final = `Battle Over! Final Score\nYou: ${userScore} vs Echo: ${echoScore}\nüèÜ Winner: ${winner}`;
      resultText.innerText = final;
      speak(`Battle Over. ${winner} wins.`);
    }

    function resetArena() {
      battleStarted = false;
      usedBars.clear();
      lastEcho = "";
      userInput.value = "";
      userBars.innerText = "";
      response.innerText = "üéôÔ∏è Go hard or go home";
      userScore = 0;
      echoScore = 0;
      timeLeft = 120;
      clearInterval(battleTimer);
      timerDisplay.innerText = "‚è± Battle Time: 2:00";
      document.getElementById("battleStats").style.display = "none";
    }
  </script>
</body>
</html>
  
