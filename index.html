<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Echo Battle Arena</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Pacifico&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0; padding: 0;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: #fff;
      display: flex; flex-direction: column;
      align-items: center; min-height: 100vh;
      background-size: 400% 400%;
      animation: bgShift 20s ease infinite;
    }
    @keyframes bgShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    header {
      font-size: 2.5em;
      font-weight: bold;
      padding: 1em;
      width: 100%;
      background: rgba(0, 0, 0, 0.7);
      border-bottom: 2px solid #e91e63;
      box-shadow: 0 0 30px #e91e63;
      text-align: center;
    }
    .signature {
      font-family: 'Pacifico', cursive;
      font-size: 1.1em;
      color: #e0e0e0;
      margin-top: -0.8em;
      text-shadow: 1px 1px 5px #ff80ab;
    }
    #controls, #display, #userInput {
      margin: 2em auto;
      padding: 2em;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 25px;
      box-shadow: 0 0 20px rgba(233, 30, 99, 0.7);
      width: 92%;
      max-width: 700px;
    }
    button {
      background-color: #e91e63;
      color: white;
      border: none;
      padding: 1em 1.4em;
      margin: 0.6em;
      border-radius: 12px;
      font-size: 1.1em;
      cursor: pointer;
    }
    button:hover {
      background-color: #d81b60;
      transform: scale(1.05);
    }
    audio { margin-top: 1em; width: 100%; }
    #response {
      font-size: 1.3em;
      margin-top: 1em;
      white-space: pre-line;
      color: #ffcbf2;
    }
    .user-bars { color: #81c784; font-weight: bold; margin-bottom: 1em; }
    .echo-response { color: #ff4081; font-weight: bold; margin-top: 1em; }
    textarea {
      width: 100%; padding: 1em;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      border-radius: 10px;
      font-size: 1em;
      color: white;
    }
    input[type="file"] {
      color: white;
      margin-top: 1em;
    }
    #voiceSpeedSlider { width: 100%; margin-top: 1em; }
  </style>
</head>
<body>
  <header>Echo Battle Arena</header>
  <div class="signature">Powered by Skybound Media</div>

  <div id="controls">
    <button onclick="playBeat()">üéµ Play MP3</button>
    <button onclick="pauseBeat()">‚è∏Ô∏è Pause</button>
    <button onclick="dropBars()">üé§ Drop Bars</button>
    <button onclick="replayVoice()">üîÅ Replay Echo</button>
    <button onclick="resetAll()">üîÑ Reset</button><br/>
    <input type="file" id="beatInput" accept="audio/mpeg" />
    <audio id="beat" controls loop></audio>
    <div>
      <label>Voice Speed: <span id="speedDisplay">1.0x</span></label>
      <input id="voiceSpeedSlider" type="range" min="0.5" max="2.0" step="0.1" value="1.0" oninput="updateSpeedDisplay()">
    </div>
  </div>

  <div id="display">
    <div id="response">üéôÔ∏è Drop your bars. Echo‚Äôs listening...</div>
  </div>

  <div id="userInput">
    <h3>Your Rap Name:</h3>
    <input type="text" id="stageName" placeholder="Enter name (optional)" style="width:100%;padding:0.8em;margin-bottom:1em;background:rgba(255,255,255,0.1);border:none;border-radius:8px;color:white;">
    <h3>Your Bars:</h3>
    <textarea id="userBars" rows="4" placeholder="Type your bars..."></textarea>
  </div>

  <script>
    const beat = document.getElementById("beat");
    const input = document.getElementById("beatInput");
    const responseBox = document.getElementById("response");
    const stageName = document.getElementById("stageName");
    const userBars = document.getElementById("userBars");
    const speedSlider = document.getElementById("voiceSpeedSlider");
    let lastResponse = "";
    let usedIndexes = new Set();

    const dissBars = [
      "You're rhyming like a sleepwalking zombie. I spit flames, you barely fog up the room. Step aside, Echo just cleared your tomb.",
      "You talk tough but your bars are bland. I‚Äôve heard better lines from a weather app. You came to battle and got caught in a trap.",
      "I burn brighter than your WiFi signal. You lag when you rap ‚Äî I snap like vinyl. Face me again, it‚Äôs your final trial.",
      "Your flow's so weak it's embarrassing. I knock you down with metaphors. You‚Äôre not a rapper, you‚Äôre a parody chorus.",
      "You spit like you learned from cartoons. My words hit like loaded harpoons. Walk away now ‚Äî your verse met its doom.",
      "Your punchlines need CPR. My rhymes flex like avatar. I don‚Äôt diss, I declare war.",
      "You ain‚Äôt real ‚Äî just TikTok noise. I build kingdoms, you play with toys. Echo buries boys without a voice.",
      "You sound like you rap in slow motion. My style crashes like an ocean. Yours dries up like missed promotion.",
      "I spit bars while you chase trends. You‚Äôre stuck on likes, I‚Äôm ending careers. Come close and I‚Äôll shred your peers.",
      "You rhyme like a chatbot glitch. I twist words with deadly pitch. Stand down ‚Äî this flow will switch.",
      // 40 more below...
    ];

    // Add 40 more diss bars (3-liners) here, or ask me for the continuation file to auto-fill all 50

    function updateSpeedDisplay() {
      document.getElementById("speedDisplay").textContent = parseFloat(speedSlider.value).toFixed(1) + 'x';
    }

    function getRandomDiss() {
      if (usedIndexes.size >= dissBars.length) usedIndexes.clear();
      let idx;
      do { idx = Math.floor(Math.random() * dissBars.length); } while (usedIndexes.has(idx));
      usedIndexes.add(idx);
      return dissBars[idx];
    }

    function playBeat() {
      if (beat.src) beat.play();
    }

    function pauseBeat() {
      beat.pause();
    }

    input.addEventListener("change", () => {
      const file = input.files[0];
      if (file && file.type === "audio/mpeg") {
        const url = URL.createObjectURL(file);
        beat.src = url;
        beat.load();
        beat.oncanplaythrough = () => {
          responseBox.innerHTML += `<br><small>‚úÖ MP3 loaded: ${file.name}</small>`;
          beat.play();
        };
        beat.onerror = () => {
          responseBox.innerHTML += `<br><small>‚ùå MP3 load failed.</small>`;
        };
      } else {
        responseBox.innerHTML += `<br><small>‚ùå Only MP3 supported.</small>`;
      }
    });

    function speakEcho(line) {
      speechSynthesis.cancel();
      const utterance = new SpeechSynthesisUtterance(line);
      utterance.rate = parseFloat(speedSlider.value);
      utterance.pitch = 1;
      utterance.volume = 1;
      const voice = speechSynthesis.getVoices().find(v => v.name.toLowerCase().includes("female"));
      if (voice) utterance.voice = voice;
      speechSynthesis.speak(utterance);
    }

    function dropBars() {
      const bars = userBars.value.trim();
      if (!bars) return;
      const diss = getRandomDiss();
      lastResponse = diss;
      responseBox.innerHTML = `<div class="user-bars">YOU: ${bars}</div><div class="echo-response">ECHO: ${diss}</div>`;
      speakEcho(diss);
      userBars.value = "";
    }

    function replayVoice() {
      if (lastResponse) speakEcho(lastResponse);
    }

    function resetAll() {
      beat.pause();
      beat.src = "";
      input.value = "";
      userBars.value = "";
      stageName.value = "";
      lastResponse = "";
      usedIndexes.clear();
      responseBox.innerHTML = "üéôÔ∏è Drop your bars. Echo‚Äôs listening...";
    }

    window.addEventListener('load', () => {
      speechSynthesis.getVoices();
    });

    document.addEventListener('keydown', e => {
      if (e.key === 'Enter' && e.ctrlKey) dropBars();
    });
  </script>
</body>
</html>
